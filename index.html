<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" 
          content="default-src 'self'; 
                   script-src 'self' https://cdn.tailwindcss.com 'unsafe-inline'; 
                   style-src 'self' https://cdn.tailwindcss.com https://cdnjs.cloudflare.com https://fonts.googleapis.com 'unsafe-inline';
                   font-src 'self' https://cdnjs.cloudflare.com https://fonts.gstatic.com;
                   img-src 'self' data: https:;
                   frame-src 'self' https://www.youtube.com;
                   connect-src 'self' https:;"> 
                   
    <title>Plateforme Vidéo ISC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --uqam-dark-blue: #003366;
            --uqam-light-blue: #337ab7;
            --uqam-grey: #f0f0f0;
            --uqam-dark-grey: #cccccc;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--uqam-grey); }
        .header-bg { background-color: var(--uqam-dark-blue); }
        .button-primary { background-color: var(--uqam-light-blue); color: white; transition: background-color 0.3s ease; }
        .button-primary:hover { background-color: #286090; }
        .button-secondary { background-color: var(--uqam-dark-grey); color: var(--uqam-dark-blue); transition: background-color 0.3s ease; }
        .button-secondary:hover { background-color: #b3b3b3; }
        .video-card { background-color: white; border: 1px solid var(--uqam-dark-grey); transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        .video-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .search-input { border: 2px solid var(--uqam-dark-blue); }
        .search-input:focus { border-color: var(--uqam-light-blue); box-shadow: 0 0 0 0.2rem rgba(51, 122, 183, 0.25); }
        
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); display: flex; justify-content: center; align-items: center; z-index: 1000; transition: opacity 0.3s ease; }
        .modal-content { background-color: white; padding: 25px; border-radius: 8px; text-align: left; box-shadow: 0 5px 20px rgba(0,0,0,0.3); width: 90%; max-width: 500px; }
        .modal-content h3 { color: var(--uqam-dark-blue); margin-bottom: 15px; }
        .modal-content label { display: block; margin-bottom: 5px; font-weight: 600; color: #333; }
        .modal-content input[type="text"], .modal-content input[type="password"], .modal-content textarea { width: 100%; padding: 10px; border: 1px solid var(--uqam-dark-grey); border-radius: 4px; margin-bottom: 15px; }
        .modal-content textarea { min-height: 80px; }

        #loadingSpinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--uqam-light-blue);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .hidden { display: none; }
        .clickable { cursor: pointer; }
        .keyword-tag {
            background-color: #e0e7ff; 
            color: #3730a3; 
            font-size: 0.75rem; 
            font-weight: 500;
            padding: 2px 8px;
            border-radius: 9999px; 
            margin-right: 4px;
            margin-bottom: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .keyword-tag:hover {
            background-color: #c7d2fe; 
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 text-gray-800">

    <header class="header-bg text-white p-4 shadow-md">
        <div class="container mx-auto flex flex-wrap items-center justify-between">
            <a href="#" onclick="showHomePage(); return false;" class="text-xl sm:text-2xl font-bold">Plateforme Vidéo ISC</a>
            
            <div class="w-full md:w-auto mt-4 md:mt-0 flex flex-col md:flex-row items-center md:ml-auto space-y-2 md:space-y-0 md:space-x-4">
                <div class="relative w-full md:w-auto">
                    <input type="search" id="searchInput" class="search-input w-full md:w-64 lg:w-80 p-2 pl-10 rounded-md text-gray-800 focus:outline-none" placeholder="Rechercher par titre, texte...">
                    <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"><i class="fas fa-search"></i></span>
                </div>
                
                <div class="relative w-full md:w-auto">
                    <select id="keywordFilter" class="search-input w-full md:w-48 p-2 rounded-md text-gray-800 focus:outline-none appearance-none">
                        <option value="">Filtrer par mot-clé...</option>
                    </select>
                    <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"><i class="fas fa-chevron-down text-xs"></i></span>
                </div>

                <div id="adminControlsContainer" class="flex flex-col md:flex-row items-center space-y-2 md:space-y-0 md:space-x-2 w-full md:w-auto">
                     <button id="adminLoginButton" class="button-secondary font-semibold py-2 px-4 rounded-md w-full md:w-auto disabled:opacity-50" disabled>Accès Admin</button>
                     <button id="addYoutubeVideoBtn" class="button-primary font-semibold py-2 px-4 rounded-md w-full md:w-auto hidden"><i class="fab fa-youtube mr-2"></i>Ajouter Vidéo</button>
                </div>
            </div>
        </div>
    </header>

    <main id="mainContent" class="container mx-auto p-4">

        <section id="videoGridPage">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-semibold text-gray-700">Vidéos disponibles</h2>
            </div>
            
            <div id="loadingIndicator" class="text-center">
                <div id="loadingSpinner"></div>
                <p class="text-gray-600">Chargement des vidéos depuis la base de données...</p>
            </div>
            
            <div id="loadingError" class="hidden text-center p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg">
                <p class="font-bold">Erreur de connexion !</p>
                <p>Impossible de charger les vidéos depuis le serveur backend.</p>
                <p class="text-sm mt-2">Veuillez vérifier que le serveur Render est bien démarré et que l'URL du backend (`backendApiUrl`) est correcte dans le code `index.html`.</p>
            </div>

            <div id="videoGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            </div>
            
            <p id="noResultsMessage" class="hidden text-center text-gray-500 mt-8 text-lg">Aucune vidéo ne correspond à votre recherche.</p>

        </section>

        <section id="videoPlayerPage" class="hidden">
            <div class="max-w-4xl mx-auto">
                <button onclick="showHomePage(); return false;" class="button-primary mb-4 py-2 px-4 rounded-md"><i class="fas fa-arrow-left mr-2"></i>Retour à la liste</button>
                
                <div class="video-player-container rounded-lg shadow-xl overflow-hidden bg-black">
                     <iframe id="mainVideoPlayerIframe" width="100%" class="aspect-video" 
                             src="" 
                             title="Lecteur vidéo YouTube" 
                             frameborder="0" 
                             allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                             allowfullscreen>
                     </iframe>
                </div>
                
                <div class="video-info bg-white p-6 mt-4 rounded-lg shadow-lg">
                    <h2 id="videoTitleElem" class="text-3xl font-bold mb-2 text-gray-800">Titre de la vidéo</h2>
                    <p id="videoUploaderElem" class="text-gray-600 mb-4">Par: <span class="font-semibold"></span></p>

                    <div id="summarySection" class="mb-6">
                        <h3 class="text-xl font-semibold text-gray-700 mb-3 border-b pb-2 flex items-center">
                            <i class="fas fa-robot mr-2 text-blue-600"></i>Résumé par IA
                        </h3>
                        <p
